---
layout: post
title: "Less is more,使用Less查看文本log"
date: 2014-01-14 23:19:34 +0800
comments: true
categories: [linux,备忘录]
---
很多服务器程序都部署在 Linux/Unix 上，因此，跟踪一些 runtime 问题往往需要到 Linux/Unix 环境中查看Log，Log文件一般为比较大的文本文件，几百M或者几个G的Log文件都很常见，特别是出现问题频繁抛出Exception或者Error的时候。这个时候使用文本工具比如vi(m)会比较慢。使用能部分加载的Less可以比较方便地查看。使用下面是这些常用的Less命令可以很方便地查看Log文件。

+ 对于比较大的log文件，行号是一个比较好的定位方式。使用下面命令打开文件显示行号。
```
less -N #{filename}
```
查看的过程中文本搜索是必不可少的,
```
/#{keyword}
```
找到对应的结果时，文本直接跳转到对应的行号，由于是部分加载，这时候只显示搜索到文本的位置以及后面的内容，这时候的上下文往往是不完整的，如果想查看前面几行的内容。需要记住当前的行号，然后往上算出想查看的行号，比如当前是10000行，而想查看9990的内容，用行号+":"跳转到对应的行查看。
```
#{line_number}g
```
这样就能比较方便快速地在比较大的log文件中查看想要的内容了。

+ 常用的打开参数。
```
-i：  忽略搜索时的大小写。
-m：  显示进度的百分比，类似于more命令的百分比更能。
-o： #{filename} 将less 输出的内容在指定文件中保存起来。
```
+ 搜索相关命令
```
/#{keywoard}：向下搜索“字符串”的功能。
?#{keywoard}：向上搜索“字符串”的功能。
n：重复前一个搜索（与 / 或 ? 有关。
n：重复前一个搜索（与 / 或 ? 有关。
&#{keyword}： - 仅显示匹配模式的行，而不是整个文件。
```
+ 导航命令
```
g: 跳转到第一行。
G: 跳转到最后一行。
j: 向前移动一行。
k或y或空格或回车: 向后移动一行。
ma: 使用 a 标记文本的当前位置, 类似于设置bookmark. 'a - 导航到标记 a 处。
b: 向前翻一页。
d: 向后翻半页。
u: 向前翻半夜
```

